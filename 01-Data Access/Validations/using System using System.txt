using System;
using System.Collections.Generic;

namespace CarRentalSystem
{
    class Program
    {
        // Car class to hold car information
        class Car
        {
            public string Model { get; set; }
            public string PlateNumber { get; set; }
            public bool IsAvailable { get; set; } = true;
        }

        // Rental record class
        class Rental
        {
            public string CustomerName { get; set; }
            public string CarModel { get; set; }
            public DateTime RentDate { get; set; }
            public DateTime? ReturnDate { get; set; }
        }

        static List<Car> cars = new List<Car>();
        static List<Rental> rentals = new List<Rental>();

        static void Main(string[] args)
        {
            // Sample cars
            cars.Add(new Car { Model = "Toyota Corolla", PlateNumber = "ABC123" });
            cars.Add(new Car { Model = "Honda Civic", PlateNumber = "XYZ789" });
            cars.Add(new Car { Model = "Ford Mustang", PlateNumber = "MUS456" });

            bool exit = false;
            while (!exit)
            {
                Console.WriteLine("\n--- Car Rental System ---");
                Console.WriteLine("1. Show Available Cars");
                Console.WriteLine("2. Rent a Car");
                Console.WriteLine("3. Return a Car");
                Console.WriteLine("4. View Rental History");
                Console.WriteLine("5. Exit");
                Console.Write("Select an option: ");
                string choice = Console.ReadLine();

                switch (choice)
                {
                    case "1":
                        ShowAvailableCars();
                        break;
                    case "2":
                        RentCar();
                        break;
                    case "3":
                        ReturnCar();
                        break;
                    case "4":
                        ViewRentalHistory();
                        break;
                    case "5":
                        exit = true;
                        break;
                    default:
                        Console.WriteLine("Invalid option. Try again.");
                        break;
                }
            }
        }

        static void ShowAvailableCars()
        {
            Console.WriteLine("\nAvailable Cars:");
            foreach (var car in cars)
            {
                if (car.IsAvailable)
                    Console.WriteLine($"{car.Model} - {car.PlateNumber}");
            }
        }

        static void RentCar()
        {
            Console.Write("\nEnter your name: ");
            string customerName = Console.ReadLine();

            Console.WriteLine("Available Cars:");
            for (int i = 0; i < cars.Count; i++)
            {
                if (cars[i].IsAvailable)
                    Console.WriteLine($"{i + 1}. {cars[i].Model} - {cars[i].PlateNumber}");
            }

            Console.Write("Select a car number to rent: ");
            if (int.TryParse(Console.ReadLine(), out int carNumber) && carNumber > 0 && carNumber <= cars.Count && cars[carNumber - 1].IsAvailable)
            {
                cars[carNumber - 1].IsAvailable = false;
                rentals.Add(new Rental
                {
                    CustomerName = customerName,
                    CarModel = cars[carNumber - 1].Model,
                    RentDate = DateTime.Now
                });
                Console.WriteLine($"You have rented {cars[carNumber - 1].Model} successfully!");
            }
            else
            {
                Console.WriteLine("Invalid selection or car not available.");
            }
        }

        static void ReturnCar()
        {
            Console.Write("\nEnter your name: ");
            string customerName = Console.ReadLine();

            var rental = rentals.Find(r => r.CustomerName.Equals(customerName, StringComparison.OrdinalIgnoreCase) && r.ReturnDate == null);
            if (rental != null)
            {
                rental.ReturnDate = DateTime.Now;
                var car = cars.Find(c => c.Model == rental.CarModel);
                if (car != null)
                    car.IsAvailable = true;

                Console.WriteLine($"You have returned {rental.CarModel}. Thank you!");
            }
            else
            {
                Console.WriteLine("No active rental found for your name.");
            }
        }

        static void ViewRentalHistory()
        {
            Console.WriteLine("\nRental History:");
            foreach (var rental in rentals)
            {
                string status = rental.ReturnDate == null ? "Rented" : $"Returned on {rental.ReturnDate}";
                Console.WriteLine($"{rental.CustomerName} rented {rental.CarModel} on {rental.RentDate} - {status}");
            }
        }
    }
}

